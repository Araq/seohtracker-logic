<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nimrod. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module l_main</title>
<style type="text/css">

span.DecNumber {color: blue}
span.BinNumber {color: blue}
span.HexNumber {color: blue}
span.OctNumber {color: blue}
span.FloatNumber {color: blue}
span.Identifier  {color: black}
span.Keyword {font-weight: bold}
span.StringLit {color: blue}
span.LongStringLit {color: blue}
span.CharLit {color: blue}
span.EscapeSequence {color: black}
span.Operator {color: black}
span.Punctuation {color: black}
span.Comment, span.LongComment {font-style:italic; color: green}
span.RegularExpression  {color: DarkViolet}
span.TagStart {color: DarkViolet}
span.TagEnd {color: DarkViolet}
span.Key  {color: blue}
span.Value  {color: black}
span.RawData {color: blue}
span.Assembler  {color: blue}
span.Preprocessor {color: DarkViolet}
span.Directive  {color: DarkViolet}
span.Command, span.Rule, span.Hyperlink, span.Label, span.Reference, 
span.Other  {color: black}

div.navigation {
  -moz-border-radius: 5px 5px 5px 5px;
  float: left; 
  width: 30%;
  margin: 0; padding: 0;
  border: 3px outset #7F7F7F;
  background-color: #7F7F7F;
}

div.navigation ul {
  list-style-type: none;
  padding-left: 1em;
}
div.navigation ul li a, div.navigation ul li a:visited {
  font-weight: bold;
  color: #FFFFFF;
  text-decoration: none;
}
div.navigation ul li a:hover {
  font-weight: bold;
  text-decoration: none;
  color: gold;
}

div.content {
  margin-left: 30%;
  padding: 0 1em;
  border-left: 4em;
}

dl.item dd, dl.item dd p {
  margin-top:3px;
}
dl.item dd pre {
  margin-left: 15pt;
  border: 0px;
}
dl.item dt, dl.item dt pre {
  margin:  20pt 0 0 5pt;
}

pre, span.tok {
  background-color: #F9F9F9;
  border-color: #C4C4C4;
  border-style: solid;
  border-width: 1px 1px 1px 2px;
  color: black;
  line-spacing: 110%;
  padding: 2px;
}

span.red {
  color: #A80000;
}

hr {background-color:#9D9D9D; border:0 none; color:#9D9D9D; height:1px; width:100%;}

/*
:Author: David Goodger
:Contact: goodger@python.org
:Date: Date: 2006-05-21 22:44:42 +0200 (Sun, 21 May 2006)
:Revision: Revision: 4564
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/
/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th { border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first { margin-top: 0 ! important }
.last, .with-subtitle { margin-bottom: 0 ! important }
.hidden { display: none }
a.toc-backref { text-decoration: none ; color: black }
blockquote.epigraph { margin: 2em 5em ; }
dl.docutils dd { margin-bottom: 0.5em }
div.abstract { margin: 2em 5em }
div.abstract p.topic-title { font-weight: bold ; text-align: center }
div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ; border: medium outset ; padding: 1em }
div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title { font-weight: bold ; font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title { color: red ; font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication { margin: 2em 5em ; text-align: center ; font-style: italic }
div.dedication p.topic-title { font-weight: bold ; font-style: normal }
div.figure { margin-left: 2em ; margin-right: 2em }
div.footer, div.header { clear: both; font-size: smaller }
div.line-block { display: block ; margin-top: 1em ; margin-bottom: 1em }
div.line-block div.line-block { margin-top: 0 ; margin-bottom: 0 ;
  margin-left: 1.5em }
div.sidebar { margin-left: 1em ; border: medium outset ;
  padding: 1em ; background-color: #ffffee ; /*width: 40% ;*/ float: right ;
  clear: right }

div.sidebar p.rubric { font-family: sans-serif ; font-size: medium }
div.system-messages { margin: 5em }
div.system-messages h1 { color: red }
div.system-message { border: medium outset ; padding: 1em }
div.system-message p.system-message-title { color: red ; font-weight: bold }
div.topic { margin: 2em;}
h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }
h1.title { text-align: center }
h2.subtitle { text-align: center }
/* hr.docutils { width: 75% } */
img.align-left { clear: left }
img.align-right { clear: right }
ol.simple, ul.simple { margin-bottom: 1em }
ol.arabic { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }
p.attribution { text-align: right ; margin-left: 50% }
p.caption { font-style: italic }
p.credits { font-style: italic ; font-size: smaller }
p.label { white-space: nowrap }
p.rubric { font-weight:bold;font-size:larger;color:maroon;text-align:center}
p.sidebar-title {font-family: sans-serif ;font-weight: bold ;font-size: larger }
p.sidebar-subtitle {font-family: sans-serif ; font-weight: bold }
p.topic-title {
font-weight: bold;
background-color: #6D6D6D;
border-bottom: 1px solid #000000;
border-top: 1px solid black;
color: white;
text-align: center;
margin: 0;
}
pre.address { margin-bottom: 0;margin-top:0;font-family:serif;font-size:100% }
pre.literal-block, pre.doctest-block {margin-left: 2em ;margin-right: 2em }
span.classifier {font-family: sans-serif;font-style: oblique }
span.classifier-delimiter {font-family: sans-serif;font-weight: bold }
span.interpreted {font-family: sans-serif }
span.option {white-space: nowrap }
span.pre {white-space: pre }
span.problematic {color: red }
span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation { border-left: solid 1px gray; margin-left: 1px }
table.docinfo {margin: 2em 4em }
table.docutils {margin-top: 0.5em;margin-bottom: 0.5em; border: 0 solid #9d9d9d; border-collapse: collapse; }
table.footnote {border-left: solid 1px black;margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {padding-left: 0.5em;padding-right: 0.5em;
  vertical-align: top;}

table.docutils td, table.docutils th { border-bottom:1px solid #9D9D9D; }
/* color: #4d4d4d} */

/* table.docutils td:hover, table.docinfo td:hover {color: #000000} */
  

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold;text-align: left;white-space: nowrap;padding-left: 0 }
  
table.docutils th
{
color: black;
font-weight:normal;
background-color: #E3E3E3;
border-top: 1px solid #1d1d1d;
border-bottom: 1px solid #1d1d1d;
}
  
h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {font-size: 100% }
ul.auto-toc { list-style-type: none }
/*a.reference { color: #E00000; font-weight:bold;}
a.reference:hover {color: #E00000;background-color: #ffff00;display: margin;
  font-weight:bold;}*/

</style>

</head>
<body>
<div class="document" id="documentId">
<h1 class="title">Module l_main</h1>
<div class="navigation" id="navigation">
<ul class="simple">
<li>
  <a class="reference" href="#6" id="56">Imports</a>
  <ul class="simple">
    
  </ul>
</li>
<li>
  <a class="reference" href="#12" id="62">Procs</a>
  <ul class="simple">
      <li><a class="reference" href="#get_weight_string,"
    title="get_weight_string*(): string not nil"><wbr />get_<wbr />weight_<wbr />string</a></li>
  <li><a class="reference" href="#format_weight_with_current_unit,PWeight"
    title="format_weight_with_current_unit*(s: PWeight): string"><wbr />format_<wbr />weight_<wbr />with_<wbr />current_<wbr />unit</a></li>
  <li><a class="reference" href="#format_weight,PWeight,bool"
    title="format_weight*(s: PWeight; add_mass: bool): string"><wbr />format_<wbr />weight</a></li>
  <li><a class="reference" href="#open_db,string"
    title="open_db*(path: string): bool"><wbr />open_<wbr />db</a></li>
  <li><a class="reference" href="#close_db,"
    title="close_db*()"><wbr />close_<wbr />db</a></li>
  <li><a class="reference" href="#get_db,"
    title="get_db*(): Tdb_conn"><wbr />get_<wbr />db</a></li>
  <li><a class="reference" href="#db_exists,string"
    title="db_exists*(path: string): bool"><wbr />db_<wbr />exists</a></li>
  <li><a class="reference" href="#add_weight,float"
    title="add_weight*(weight: float): int"><wbr />add_<wbr />weight</a></li>
  <li><a class="reference" href="#remove_weight,PWeight"
    title="remove_weight*(weight: PWeight): int"><wbr />remove_<wbr />weight</a></li>
  <li><a class="reference" href="#get_num_weights,"
    title="get_num_weights*(): int"><wbr />get_<wbr />num_<wbr />weights</a></li>
  <li><a class="reference" href="#find_pos,PWeight"
    title="find_pos*(w: PWeight): int"><wbr />find_<wbr />pos</a></li>
  <li><a class="reference" href="#modify_weight_date,PWeight,TTime,int,int"
    title="modify_weight_date*(w: PWeight; value: TTime; old_pos, new_pos: var int)"><wbr />modify_<wbr />weight_<wbr />date</a></li>
  <li><a class="reference" href="#modify_weight_value,PWeight,float"
    title="modify_weight_value*(w: PWeight; value: float): int"><wbr />modify_<wbr />weight_<wbr />value</a></li>
  <li><a class="reference" href="#get_last_weight,"
    title="get_last_weight*(): PWeight"><wbr />get_<wbr />last_<wbr />weight</a></li>
  <li><a class="reference" href="#get_weight,int"
    title="get_weight*(pos: int): PWeight"><wbr />get_<wbr />weight</a></li>
  <li><a class="reference" href="#get_localized_weight,PWeight"
    title="get_localized_weight*(s: PWeight): float"><wbr />get_<wbr />localized_<wbr />weight</a></li>
  <li><a class="reference" href="#set_decimal_separator,char"
    title="set_decimal_separator*(value: char): bool"><wbr />set_<wbr />decimal_<wbr />separator</a></li>
  <li><a class="reference" href="#get_decimal_separator,"
    title="get_decimal_separator*(): char"><wbr />get_<wbr />decimal_<wbr />separator</a></li>
  <li><a class="reference" href="#specify_metric_use,bool"
    title="specify_metric_use*(uses_metric: bool)"><wbr />specify_<wbr />metric_<wbr />use</a></li>
  <li><a class="reference" href="#get_metric_use,"
    title="get_metric_use*(): Weight_type"><wbr />get_<wbr />metric_<wbr />use</a></li>
  <li><a class="reference" href="#max_weight,"
    title="max_weight*(): int"><wbr />max_<wbr />weight</a></li>
  <li><a class="reference" href="#is_weight_input_valid,string"
    title="is_weight_input_valid*(future: string): bool"><wbr />is_<wbr />weight_<wbr />input_<wbr />valid</a></li>
  <li><a class="reference" href="#export_database_to_csv,string"
    title="export_database_to_csv*(csv_filename: string): bool"><wbr />export_<wbr />database_<wbr />to_<wbr />csv</a></li>
  <li><a class="reference" href="#scan_csv_for_entries,string"
    title="scan_csv_for_entries*(csv_filename: string): int"><wbr />scan_<wbr />csv_<wbr />for_<wbr />entries</a></li>
  <li><a class="reference" href="#import_csv_into_db,string,bool"
    title="import_csv_into_db*(csv_filename: string; replace: bool): bool"><wbr />import_<wbr />csv_<wbr />into_<wbr />db</a></li>

  </ul>
</li>

</ul>
</div>
<div class="content" id="content">
<p><a class="reference external" href="https://github.com/gradha/seohtracker-logic">Seohtracker logic</a> main module.</p>
<p>This is the module that clients have to import. It keeps some global variables around to preserve the state between calls and simplify the API. A client should first open a database connection with <tt class="docutils literal"><span class="pre">open_db</span></tt> passing a platform specific path for file storage. The <tt class="docutils literal"><span class="pre">close_db</span></tt> proc can be used to cleanly close the database.</p>
<p>Some global variables are used for localization and formatting, so you might need to set those, preferably before opening the database connection.  These are <tt class="docutils literal"><span class="pre">set_decimal_separator</span></tt> and <tt class="docutils literal"><span class="pre">specify_metric_use</span></tt>.</p>
<p>Once the database is open, you can use different procs to access the stored data: <tt class="docutils literal"><span class="pre">add_weight</span></tt>, <tt class="docutils literal"><span class="pre">remove_weight</span></tt>, <tt class="docutils literal"><span class="pre">get_num_weights</span></tt>, <tt class="docutils literal"><span class="pre">find_pos</span></tt>, <tt class="docutils literal"><span class="pre">modify_weight_date</span></tt>, <tt class="docutils literal"><span class="pre">modify_weight_value</span></tt>, etc. See all the other exported procs for information.</p>
<p>To browse the constants and other types used here, browse the <a class="reference external" href="l_types.html">l_types module</a>.</p>

<div class="section" id="6">
<h1><a class="toc-backref" href="#56">Imports</a></h1>
<dl class="item">
<a class="reference external" href="db_sqlite.html">db_sqlite</a>, <a class="reference external" href="strutils.html">strutils</a>, <a class="reference external" href="times.html">times</a>, <a class="reference external" href="os.html">os</a>, <a class="reference external" href="l_db.html">l_db</a>, <a class="reference external" href="l_types.html">l_types</a>, <a class="reference external" href="parseutils.html">parseutils</a>, <a class="reference external" href="l_log.html">l_log</a>
</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#62">Procs</a></h1>
<dl class="item">
<dt id="get_weight_string"><a name="get_weight_string,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">get_weight_string</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Keyword">not</span> <span class="Keyword">nil</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Allows C code know the string for the current WEIGHT_DEFAULT setting.

</dd>
<dt id="format_weight_with_current_unit"><a name="format_weight_with_current_unit,PWeight"></a><pre><span class="Keyword">proc</span> <span class="Identifier">format_weight_with_current_unit</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">PWeight</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Formats the weight for the UI.</p>
<p>The difference from other methods is that this one convers the weight to the current mass of unit if different according to WEIGHT_DEFAULT.</p>
<p>If s is nil, the value zero is returned.</p>


</dd>
<dt id="format_weight"><a name="format_weight,PWeight,bool"></a><pre><span class="Keyword">proc</span> <span class="Identifier">format_weight</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">PWeight</span><span class="Other">;</span> <span class="Identifier">add_mass</span><span class="Other">:</span> <span class="Identifier">bool</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Formats the weight for the UI.</p>
<p>If s is nil, the value zero is returned. If add_mass is true, the string of the weight type is appended.</p>


</dd>
<dt id="open_db"><a name="open_db,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">open_db</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">path</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Opens the database.</p>
<p>Pass the directory where you want the database to be opened. The filename is always a constant you can't change, and will be appended to the provided <cite>path</cite>.</p>
<p>Returns true if the database was opened and loaded into memory.</p>


</dd>
<dt id="close_db"><a name="close_db,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">close_db</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Mostly for unit tests, closes the sqlite and clears the global variables.</p>
<p>Problems are logged and ignored.</p>


</dd>
<dt id="get_db"><a name="get_db,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">get_db</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Tdb_conn</span></pre></dt>
<dd>
<p>For unit testing, returns the current global database connection.</p>
<p>This allows unit tests to execute special queries not part of the default database logic module.</p>


</dd>
<dt id="db_exists"><a name="db_exists,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">db_exists</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">path</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Returns true if the database exists at the specified path.</p>
<p>Use this before calling open_db, since opening an sqlite database already generates a zero byte file. This proc doesn't modify the current DB_PATH global.</p>


</dd>
<dt id="add_weight"><a name="add_weight,float"></a><pre><span class="Keyword">proc</span> <span class="Identifier">add_weight</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">weight</span><span class="Other">:</span> <span class="Identifier">float</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Adds a new weight to the database.</p>
<p>Returns the position of the weight in the list if the addition succeeded, negative otherwise.</p>


</dd>
<dt id="remove_weight"><a name="remove_weight,PWeight"></a><pre><span class="Keyword">proc</span> <span class="Identifier">remove_weight</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">weight</span><span class="Other">:</span> <span class="Identifier">PWeight</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">{.</span><span class="Identifier">discardable</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Removes the specified weight from the database.</p>
<p>Returns the position of the entry in the global list before removal if it was successful, or negative if the removal could not be made.</p>


</dd>
<dt id="get_num_weights"><a name="get_num_weights,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">get_num_weights</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Returns the number of weights stored in the database.

</dd>
<dt id="find_pos"><a name="find_pos,PWeight"></a><pre><span class="Keyword">proc</span> <span class="Identifier">find_pos</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">w</span><span class="Other">:</span> <span class="Identifier">PWeight</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Finds the position of the weight in based on the identifier.</p>
<p>If the weight is not found, negative is returned.</p>


</dd>
<dt id="modify_weight_date"><a name="modify_weight_date,PWeight,TTime,int,int"></a><pre><span class="Keyword">proc</span> <span class="Identifier">modify_weight_date</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">w</span><span class="Other">:</span> <span class="Identifier">PWeight</span><span class="Other">;</span> <span class="Identifier">value</span><span class="Other">:</span> <span class="Identifier">TTime</span><span class="Other">;</span> <span class="Identifier">old_pos</span><span class="Other">,</span> <span class="Identifier">new_pos</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">int</span><span class="Other">)</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Modifies the date of a weight entry.</p>
<p>Since weights are sorted by date, this could change their position. Therefore the method stores into old_pos and new_pos the old/new positions in VALUES. If anything goes wrong, negative values will be stored. Pass the weight you want to modify, and the new date.</p>


</dd>
<dt id="modify_weight_value"><a name="modify_weight_value,PWeight,float"></a><pre><span class="Keyword">proc</span> <span class="Identifier">modify_weight_value</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">w</span><span class="Other">:</span> <span class="Identifier">PWeight</span><span class="Other">;</span> <span class="Identifier">value</span><span class="Other">:</span> <span class="Identifier">float</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Changes the weight of an existing weight element.</p>
<p>Returns the position of the weight in the global array, or negative if it wasn't found there.</p>


</dd>
<dt id="get_last_weight"><a name="get_last_weight,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">get_last_weight</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">PWeight</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Returns the last weight or nil if none was available.

</dd>
<dt id="get_weight"><a name="get_weight,int"></a><pre><span class="Keyword">proc</span> <span class="Identifier">get_weight</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">pos</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">PWeight</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Returns the weight at the specified position or nil for out of bounds.

</dd>
<dt id="get_localized_weight"><a name="get_localized_weight,PWeight"></a><pre><span class="Keyword">proc</span> <span class="Identifier">get_localized_weight</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">PWeight</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">float</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Returns the localized weight to the current global weight unit.</p>
<p>If <cite>s</cite> is nil, a default weight is returned for the UI to not start the weight selectors at zero.</p>


</dd>
<dt id="set_decimal_separator"><a name="set_decimal_separator,char"></a><pre><span class="Keyword">proc</span> <span class="Identifier">set_decimal_separator</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">value</span><span class="Other">:</span> <span class="Identifier">char</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span class="Other">{.</span><span class="Identifier">discardable</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Allow native code to initialize the separator for formatting.</p>
<p>This proc always works, but it returns false if the previously set global separator was the same to the new one, returning true if the value did change.</p>


</dd>
<dt id="get_decimal_separator"><a name="get_decimal_separator,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">get_decimal_separator</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">char</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Returns the currently used decimal separator.

</dd>
<dt id="specify_metric_use"><a name="specify_metric_use,bool"></a><pre><span class="Keyword">proc</span> <span class="Identifier">specify_metric_use</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">uses_metric</span><span class="Other">:</span> <span class="Identifier">bool</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Allow native code to specify if the metric system is in use.</p>
<p>This sets the default for input/formatting values. Pass true if the metric system (kg) is in use vs the US system (lb).</p>


</dd>
<dt id="get_metric_use"><a name="get_metric_use,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">get_metric_use</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Weight_type</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Returns the current weight default.

</dd>
<dt id="max_weight"><a name="max_weight,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">max_weight</span><span class="Operator">*</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Returns the maximum weight in the current default unit.</p>
<p>It's amazing what the human body can suffer: <a class="reference external" href="http://mostextreme.org/heaviest_person.php">http://mostextreme.org/heaviest_person.php</a></p>


</dd>
<dt id="is_weight_input_valid"><a name="is_weight_input_valid,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">is_weight_input_valid</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Validates a future input string as value for user_input_to_float.</p>
<p>Returns false if the string contains any characters not liked by the proc. This proc is meant to be as a runtime check for users typing text into a field, so it will report as valid the empty string.</p>


</dd>
<dt id="export_database_to_csv"><a name="export_database_to_csv,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">export_database_to_csv</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">csv_filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Takes the current database content and writes it into csv_filename.</p>
<p>Pass a full path to csv_filename. Returns true if the proc didn't found any problems. If false is returned, you may need to remove any half created file at the specified path.</p>


</dd>
<dt id="scan_csv_for_entries"><a name="scan_csv_for_entries,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">scan_csv_for_entries</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">csv_filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Returns the number of entries in the file, or zero on error.

</dd>
<dt id="import_csv_into_db"><a name="import_csv_into_db,string,bool"></a><pre><span class="Keyword">proc</span> <span class="Identifier">import_csv_into_db</span><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">csv_filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">replace</span><span class="Other">:</span> <span class="Identifier">bool</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Reads csv_filename and adds its contents to the global database.</p>
<p>If replace is true, the database will first be deleted. Returns false if there was any problem during the whole process.</p>


</dd>

</dl></div>

</div>

<small>Generated: 2014-06-25 20:45:25 UTC</small>
</div>
</body>
</html>
